<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>War of Villages â€“ 1 hrÃ¡Ä</title>
  <style>
    body { margin:0; background:#333; color:white; font-family:sans-serif; }
    #hud { padding:10px; background:#0008; font-size:18px; }
    #panel { display:flex; gap:10px; padding:10px; background:#111; flex-wrap:wrap; }
    .btn { padding:8px 14px; background:#444; border-radius:8px; cursor:pointer; } .btn:hover{ background:#666; }
    #game { position:relative; width:3000px; height:75vh; background:#2e7d32; overflow:hidden; }
    .base { position:absolute; bottom:0; width:100px; height:150px; background:#795548; text-align:center; font-size:24px; }
    .unit { position:absolute; bottom:0; width:40px; height:60px; text-align:center; line-height:60px; border-radius:5px; }
    .enemy { background:red; } .friend { background:blue; }
    .arrow { position:absolute; width:12px; height:4px; background:yellow; }
    .fireball { position:absolute; width:15px; height:15px; background:orange; border-radius:50%; }
    .rock { position:absolute; width:18px; height:18px; background:gray; border-radius:3px; }
    #message { position:fixed; inset:0; display:flex; justify-content:center; align-items:center; background:rgba(0,0,0,0.7); font-size:48px; font-weight:bold; }
    #message.hidden { display:none; }
  </style>
</head>
<body>
  <div id="hud">ğŸ’° Zlato: <span id="gold">50</span> | ğŸ  Moje HP: <span id="myhp">150</span> | ğŸ  NepÅ™Ã­tel HP: <span id="enemyhp">150</span></div>
  <div id="panel">
    <div class="btn" onclick="buy('warrior','attack')">ğŸª“ PÄ›Å¡Ã¡k Ãštok (10)</div>
    <div class="btn" onclick="buy('warrior','defend')">ğŸª“ PÄ›Å¡Ã¡k Obrana (10)</div>
    <div class="btn" onclick="buy('archer','attack')">ğŸ¹ LukostÅ™elec Ãštok (20)</div>
    <div class="btn" onclick="buy('archer','defend')">ğŸ¹ LukostÅ™elec Obrana (20)</div>
    <div class="btn" onclick="buy('tank','attack')">ğŸ›¡ï¸ TÄ›Å¾kÃ½ Ãštok (30)</div>
    <div class="btn" onclick="buy('tank','defend')">ğŸ›¡ï¸ TÄ›Å¾kÃ½ Obrana (30)</div>
    <div class="btn" onclick="buy('wizard','attack')">ğŸ§™ KouzelnÃ­k Ãštok (40)</div>
    <div class="btn" onclick="buy('wizard','defend')">ğŸ§™ KouzelnÃ­k Obrana (40)</div>
    <div class="btn" onclick="buy('catapult','attack')">ğŸª– Katapult Ãštok (60)</div>
    <div class="btn" onclick="buy('catapult','defend')">ğŸª– Katapult Obrana (60)</div>
    <div class="btn" onclick="buy('miner')">â›ï¸ DÄ›lnÃ­k (20)</div>
  </div>
  <div id="game">
    <div class="base" style="left:0">ğŸ </div>
    <div class="base" style="right:0">ğŸ </div>
  </div>
  <div id="message" class="hidden"></div>

<script>
  const game=document.getElementById("game");
  const goldEl=document.getElementById("gold");
  const myHpEl=document.getElementById("myhp");
  const enemyHpEl=document.getElementById("enemyhp");
  const msg=document.getElementById("message");

  let gold=50,myHP=150,enemyHP=150;
  let units=[],projectiles=[];

  const stats={
    warrior:{hp:10,dmg:2,speed:1,range:0,cost:10,type:"melee"},
    archer:{hp:6,dmg:2,speed:1,range:250,cost:20,type:"arrow"},
    tank:{hp:25,dmg:4,speed:0.5,range:0,cost:30,type:"melee"},
    wizard:{hp:12,dmg:3,speed:0.8,range:220,cost:40,type:"fireball"},
    catapult:{hp:30,dmg:6,speed:0.4,range:400,cost:60,type:"rock"},
    miner:{hp:5,dmg:0,speed:0,range:0,cost:20,type:"miner"}
  };

  function buy(type,mode){
    const s=stats[type]; if(gold<s.cost) return;
    gold-=s.cost; goldEl.textContent=gold;
    spawn(type,false,mode);
  }

  function spawn(type,enemy,mode){
    const u=document.createElement("div");
    u.className="unit "+(enemy?"enemy":"friend"); u.textContent=emoji(type);
    game.appendChild(u);
    units.push({el:u,type,hp:stats[type].hp,dmg:stats[type].dmg,speed:stats[type].speed,range:stats[type].range,enemy,mode,x:enemy?game.clientWidth-140:120});
  }

  function emoji(t){ return {warrior:"ğŸª“",archer:"ğŸ¹",tank:"ğŸ›¡ï¸",wizard:"ğŸ§™",catapult:"ğŸª–",miner:"â›ï¸"}[t]||"?"; }

  // AI soupeÅ™ â€“ nÃ¡hodnÄ› posÃ­lÃ¡ ÃºtoÄnÃ­ky
  setInterval(()=>{
    const types=["warrior","archer","tank","wizard","catapult"];
    const t=types[Math.floor(Math.random()*types.length)];
    spawn(t,true,"attack");
  },3500);

  // pasivnÃ­ zlato
  setInterval(()=>{ gold+=3; goldEl.textContent=gold; },2000);

  function loop(){
    units.forEach((u,i)=>{
      if(u.hp<=0){ u.el.remove(); units.splice(i,1); return; }

      if(u.type==="miner"){
        if(!u.cooldown||u.cooldown<=0){ gold+=5; goldEl.textContent=gold; u.cooldown=180; } else u.cooldown--;
        u.x = u.enemy ? game.clientWidth-160 : 120; u.el.style.left=u.x+"px"; return;
      }

      // pohyb (obrÃ¡nci stojÃ­)
      if(u.mode==="attack"){ u.x+=(u.enemy?-1:1)*u.speed; }
      else { u.x = u.enemy ? game.clientWidth-160 : 120; }
      u.el.style.left=u.x+"px";

      // cÃ­l
      const target=units.find(t=>t.enemy!==u.enemy && Math.abs(t.x-u.x)<(u.range>0?u.range:40));
      if(target){
        if(u.range>0){ if(Math.random()<0.02) shoot(u); }
        else{ target.hp-=u.dmg*0.1; }
      }else{
        if(!u.enemy && u.x>game.clientWidth-150){ enemyHP-=u.dmg*0.2; enemyHpEl.textContent=Math.floor(enemyHP); if(enemyHP<=0) end(true); }
        if(u.enemy && u.x<150){ myHP-=u.dmg*0.2; myHpEl.textContent=Math.floor(myHP); if(myHP<=0) end(false); }
      }
    });

    projectiles.forEach((p,i)=>{
      p.x+=p.dir*4; p.el.style.left=p.x+"px";
      const hit=units.find(u=>u.enemy!==p.enemy && Math.abs(u.x-p.x)<20);
      if(hit){ hit.hp-=p.dmg; if(p.type==="fireball"||p.type==="rock"){ units.forEach(u2=>{ if(u2.enemy!==p.enemy && Math.abs(u2.x-p.x)<50) u2.hp-=p.dmg*0.5; }); } p.el.remove(); projectiles.splice(i,1); }
      if(p.x<0||p.x>game.clientWidth){ p.el.remove(); projectiles.splice(i,1); }
    });

    requestAnimationFrame(loop);
  }

  function shoot(u){
    const p=document.createElement("div");
    let cls="arrow"; if(u.type==="fireball") cls="fireball"; if(u.type==="rock") cls="rock";
    p.className=cls; p.style.bottom="80px"; p.style.left=u.x+"px"; game.appendChild(p);
    projectiles.push({el:p,x:u.x,dir:u.enemy?-1:1,dmg:u.dmg,enemy:u.enemy,type:u.type});
  }

  function end(win){ const m=win?"ğŸ‰ VyhrÃ¡l jsi!":"ğŸ’€ ProhrÃ¡l jsi!"; const overlay=document.getElementById("message"); overlay.classList.remove("hidden"); overlay.textContent=m; setTimeout(()=>location.reload(),4000); }

  loop();
</script>
</body>
</html>
